# Implementation Tasks: sample-data-seed

- [x] 1. サンプルデータシードの実行エントリを用意する (P)
  - コマンドラインからサンプルデータシードを実行できる npm スクリプトや CLI エントリの方針を決め、開発者や CI から 1 コマンドで起動できるようにする。
  - 設計で定義した SampleDataSeedCLI の責務（引数解釈、終了コード、ログ出力）を踏まえ、実行時に必要な environment や dryRun オプションをどのように指定するかを整理する。
  - _Requirements: 1.1, 1.2, 4.1_

- [x] 2. サンプル Team データセットの仕様を固める (P)
  - Team.name を論理キーとし、country や foundedYear を含めた代表的なクラブのサンプル一覧を決める。
  - 最低限の件数とバリエーション（異なる国や歴史を持つチームなど）を検討し、契約シミュレーションの起点として十分な構成にする。
  - _Requirements: 1.2, 1.4, 1.5_

- [x] 2.1 サンプル Team データを投入できるようにする (P)
  - Team.name を基準とした upsert 戦略で、サンプル Team が既に存在する場合は更新し、存在しない場合は作成する振る舞いを実現する。
  - サンプル Team の件数や属性が要件で想定する代表性を満たしているか確認し、後続の Player データとの論理的な関連づけが可能な状態にする。
  - _Requirements: 1.2, 1.4, 2.1, 2.2, 2.4_

- [x] 3. サンプル Player データセットの仕様を固める (P)
  - ポジション、年齢、overall/potential、marketValue、currentClub などを含む代表的な選手プロファイルのパターンを設計する。
  - 各 Player がどの Team に所属するかを currentClub など既存フィールドを用いて表現し、一覧画面で現実的な構成に見えるようにする。
  - _Requirements: 1.1, 1.3, 1.5_

- [ ] 3.1 サンプル Player データを投入できるようにする (P)
  - Player.name と position を論理キーとした upsert 戦略で、サンプル Player が既に存在する場合は更新し、存在しない場合は作成する。
  - 全てのサンプル Player が有効なポジション定義と年齢・能力値・市場価値を持ち、少なくとも 1 チームには論理的に所属している状態になるようにする。
  - _Requirements: 1.1, 1.3, 1.4, 2.1, 2.2, 2.3, 2.4_

- [x] 4. サンプルデータシード処理の環境ガードを実装する
  - options.environment や環境変数を用いて、開発・検証など許可された環境と、本番相当環境を区別する条件を整理する。
  - 許可されていない environment でシードが実行されそうな場合に、DB 書き込みを行わずエラーメッセージを返す振る舞いを定義する。
  - _Requirements: 3.1, 3.2, 3.3_

- [ ] 4.1 サンプルデータシード処理のトランザクションとロールバック方針を決める
  - Team と Player のシードをどの単位でトランザクションとして扱うかを決め、途中でエラーが発生した場合に不整合状態を残さないようにする。
  - 一部のエンティティで失敗があっても全体をロールバックするのか、成功分を残してエラーを集約報告するのかといった動作方針を整理する。
  - _Requirements: 2.3, 3.4_

- [ ] 5. SampleDataSeedService の実行結果サマリを整える (P)
  - 作成/更新された Player/Team の件数とエラー件数を SampleDataSeedResult として集約し、呼び出し元で利用しやすい構造にする。
  - 正常系・部分成功・全体失敗などのパターンごとに、結果サマリの表現が一貫しているかを確認する。
  - _Requirements: 2.5, 4.1, 4.3_

- [ ] 5.1 サンプルデータシードのエラー情報を収集・表現する
  - どのエンティティのどの識別子でどのようなエラーが発生したかを SampleDataSeedError として表現できるようにし、メッセージ内容の粒度を決める。
  - データ整合性エラーやスキーマ不整合など、再実行や修正の判断に役立つ情報が含まれていることを確認する。
  - _Requirements: 2.5, 4.2, 4.3_

- [ ] 6. SampleDataSeedCLI からの結果表示と終了コード制御を実装する (P)
  - SampleDataSeedService.run の結果を CLI 上で人間が読みやすいサマリとして表示し、件数とエラー有無が一目で分かるようにする。
  - 成功時・部分成功時・失敗時の終了コードを決め、CI などから判定可能にする。
  - _Requirements: 4.1, 4.3, 4.5_

- [ ] 7. サンプルデータシードの実行履歴・観測性を高める
  - 実行開始時刻・終了時刻・対象 environment・結果サマリをログとして出力し、少なくとも直近の実行状況を追跡できるようにする。
  - 将来的に既存のモニタリング基盤へ連携することを見据え、ログフォーマットや項目を過不足ないレベルで整理する。
  - _Requirements: 4.1, 4.4, 4.5_

- [ ] 8. サンプルデータシード処理の統合テストを実装する
  - テスト用 DB を用いてシードを実行し、Player / Team の件数や代表的な属性値が要件どおりに投入されているかを検証する。
  - 再実行時にレコード件数が増加せず更新のみが行われることや、環境ガードが意図したとおりに機能していることを確認する。
  - _Requirements: 1.1, 1.2, 1.3, 1.4, 2.1, 2.2, 2.3, 3.1, 3.2, 3.3_

- [ ]* 9. サンプルデータシードと UI の結合を検証するテストを追加する
  - シード実行後に Player / Team 一覧画面で代表的なサンプルデータが表示されることを確認する E2E/結合テストを追加する。
  - サンプルデータの代表性（複数ポジションや複数チームなど）が UI 上で分かるかどうかを、テスト観点として整理する。
  - _Requirements: 1.1, 1.2, 1.5, 4.5_
